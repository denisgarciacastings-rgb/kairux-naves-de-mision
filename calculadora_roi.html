<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora ROI y Rentabilidad - PYME Motor 360</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            padding: 30px;
            background: #f8f9fa;
        }
        
        .metric-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            transition: transform 0.3s ease;
            border-left: 5px solid #27ae60;
        }
        
        .metric-card:hover {
            transform: translateY(-5px);
        }
        
        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .metric-label {
            color: #666;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .positive { color: #27ae60; }
        .negative { color: #e74c3c; }
        .warning { color: #f39c12; }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            padding: 30px;
        }
        
        .section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }
        
        .section h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.3rem;
            border-bottom: 3px solid #27ae60;
            padding-bottom: 10px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }
        
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #27ae60;
        }
        
        .btn {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            width: 100%;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(39, 174, 96, 0.4);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        }
        
        .btn-secondary:hover {
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        
        .result-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        
        .result-value {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .result-label {
            color: #666;
            font-size: 0.9rem;
        }
        
        .investment-list {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .investment-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 4px solid #27ae60;
        }
        
        .investment-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .investment-title {
            font-weight: bold;
            color: #2c3e50;
        }
        
        .investment-roi {
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        .investment-details {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            font-size: 0.9rem;
            color: #666;
        }
        
        .recommendation {
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
        }
        
        .recommendation h4 {
            margin-bottom: 10px;
            font-size: 1.2rem;
        }
        
        .chart-container {
            grid-column: 1 / -1;
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin: 0 30px 30px 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }
        
        .chart {
            height: 300px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-size: 1.1rem;
        }
        
        .tabs {
            display: flex;
            background: #f8f9fa;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 20px;
        }
        
        .tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        
        .tab.active {
            background: #27ae60;
            color: white;
        }
        
        .tab:hover {
            background: #ddd;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .comparison-table th,
        .comparison-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .comparison-table th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .roi-indicator {
            display: inline-block;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 10px;
        }
        
        .roi-high { background-color: #27ae60; }
        .roi-medium { background-color: #f39c12; }
        .roi-low { background-color: #e74c3c; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìä Calculadora ROI y Rentabilidad</h1>
            <p>An√°lisis inteligente de retorno de inversi√≥n para decisiones estrat√©gicas</p>
        </div>
        
        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-label">ROI Promedio</div>
                <div class="metric-value positive" id="roiPromedio">0%</div>
                <small>Todas las inversiones</small>
            </div>
            <div class="metric-card">
                <div class="metric-label">Mejor Inversi√≥n</div>
                <div class="metric-value positive" id="mejorInversion">0%</div>
                <small>Mayor retorno</small>
            </div>
            <div class="metric-card">
                <div class="metric-label">Tiempo Retorno</div>
                <div class="metric-value warning" id="tiempoRetorno">0 meses</div>
                <small>Promedio recuperaci√≥n</small>
            </div>
            <div class="metric-card">
                <div class="metric-label">Total Invertido</div>
                <div class="metric-value" id="totalInvertido">‚Ç°0</div>
                <small>Capital en juego</small>
            </div>
            <div class="metric-card">
                <div class="metric-label">Ganancia Neta</div>
                <div class="metric-value positive" id="gananciaNeta">‚Ç°0</div>
                <small>Beneficio total</small>
            </div>
            <div class="metric-card">
                <div class="metric-label">Score Inversi√≥n</div>
                <div class="metric-value" id="scoreInversion">0/10</div>
                <small>√çndice de calidad</small>
            </div>
        </div>
        
        <div class="main-content">
            <div class="section">
                <div class="tabs">
                    <div class="tab active" onclick="switchTab('nueva')">Nueva Inversi√≥n</div>
                    <div class="tab" onclick="switchTab('comparar')">Comparar</div>
                </div>
                
                <div id="nueva" class="tab-content active">
                    <h3>üí∞ Calcular Nueva Inversi√≥n</h3>
                    <form id="inversionForm">
                        <div class="form-group">
                            <label for="nombreInversion">Nombre de la Inversi√≥n</label>
                            <input type="text" id="nombreInversion" placeholder="Ej: Nuevo equipo, Marketing digital, Capacitaci√≥n..." required>
                        </div>
                        
                        <div class="form-group">
                            <label for="montoInversion">Monto de Inversi√≥n (‚Ç°)</label>
                            <input type="number" id="montoInversion" min="0" step="0.01" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="ingresoMensual">Ingreso Mensual Esperado (‚Ç°)</label>
                            <input type="number" id="ingresoMensual" min="0" step="0.01" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="costoMensual">Costo Mensual de Mantenimiento (‚Ç°)</label>
                            <input type="number" id="costoMensual" min="0" step="0.01" value="0">
                        </div>
                        
                        <div class="form-group">
                            <label for="periodoAnalisis">Per√≠odo de An√°lisis (meses)</label>
                            <input type="number" id="periodoAnalisis" min="1" max="120" value="12" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="riesgo">Nivel de Riesgo</label>
                            <select id="riesgo" required>
                                <option value="">Seleccionar riesgo</option>
                                <option value="bajo">üü¢ Bajo (1-2)</option>
                                <option value="medio">üü° Medio (3-5)</option>
                                <option value="alto">üî¥ Alto (6-10)</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="descripcion">Descripci√≥n</label>
                            <textarea id="descripcion" rows="3" placeholder="Detalles adicionales de la inversi√≥n..."></textarea>
                        </div>
                        
                        <button type="submit" class="btn">üìä Calcular ROI</button>
                    </form>
                </div>
                
                <div id="comparar" class="tab-content">
                    <h3>‚öñÔ∏è Comparar Inversiones</h3>
                    <p style="color: #666; margin-bottom: 20px;">Selecciona dos inversiones para compararlas:</p>
                    
                    <div class="form-group">
                        <label for="inversion1">Primera Inversi√≥n</label>
                        <select id="inversion1">
                            <option value="">Seleccionar inversi√≥n</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="inversion2">Segunda Inversi√≥n</label>
                        <select id="inversion2">
                            <option value="">Seleccionar inversi√≥n</option>
                        </select>
                    </div>
                    
                    <button type="button" class="btn btn-secondary" onclick="compararInversiones()">üîç Comparar</button>
                    
                    <div id="comparacionResultados"></div>
                </div>
            </div>
            
            <div class="section">
                <h3>üìà Resultados del An√°lisis</h3>
                <div id="resultadosAnalisis">
                    <p style="text-align: center; color: #666; padding: 40px;">
                        Ingrese los datos de una inversi√≥n para ver el an√°lisis completo
                    </p>
                </div>
            </div>
        </div>
        
        <div class="section" style="margin: 0 30px 30px 30px;">
            <h3>üíº Portfolio de Inversiones</h3>
            <div class="investment-list" id="investmentList">
                <!-- Las inversiones aparecer√°n aqu√≠ -->
            </div>
        </div>
        
        <div class="chart-container">
            <h3>üìä An√°lisis Temporal de ROI</h3>
            <div class="chart">
                üìà Gr√°fico de evoluci√≥n ROI se conectar√° con Looker Studio
            </div>
        </div>
    </div>

    <script>
        let inversiones = [];
        
        // Cambiar tabs
        function switchTab(tabName) {
            // Remover active de todos los tabs
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // Activar el tab seleccionado
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
            
            if (tabName === 'comparar') {
                actualizarSelectoresComparacion();
            }
        }
        
        // Manejar env√≠o del formulario
        document.getElementById('inversionForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const inversion = {
                id: Date.now(),
                nombre: document.getElementById('nombreInversion').value,
                monto: parseFloat(document.getElementById('montoInversion').value),
                ingresoMensual: parseFloat(document.getElementById('ingresoMensual').value),
                costoMensual: parseFloat(document.getElementById('costoMensual').value),
                periodo: parseInt(document.getElementById('periodoAnalisis').value),
                riesgo: document.getElementById('riesgo').value,
                descripcion: document.getElementById('descripcion').value,
                fecha: new Date().toISOString()
            };
            
            // Calcular m√©tricas
            const beneficioMensual = inversion.ingresoMensual - inversion.costoMensual;
            const beneficioTotal = beneficioMensual * inversion.periodo;
            const roi = ((beneficioTotal - inversion.monto) / inversion.monto) * 100;
            const tiempoRetorno = inversion.monto / beneficioMensual;
            const roiAnual = (roi / inversion.periodo) * 12;
            
            inversion.beneficioMensual = beneficioMensual;
            inversion.beneficioTotal = beneficioTotal;
            inversion.roi = roi;
            inversion.tiempoRetorno = tiempoRetorno;
            inversion.roiAnual = roiAnual;
            
            inversiones.push(inversion);
            
            // Mostrar resultados
            mostrarResultados(inversion);
            
            // Limpiar formulario
            this.reset();
            document.getElementById('periodoAnalisis').value = 12;
            
            // Actualizar interfaz
            actualizarDashboard();
            actualizarListaInversiones();
        });
        
        function mostrarResultados(inversion) {
            const container = document.getElementById('resultadosAnalisis');
            
            let recomendacion = '';
            let colorROI = '';
            
            if (inversion.roi > 50) {
                recomendacion = 'EXCELENTE inversi√≥n con alto retorno';
                colorROI = 'positive';
            } else if (inversion.roi > 20) {
                recomendacion = 'BUENA inversi√≥n, retorno aceptable';
                colorROI = 'positive';
            } else if (inversion.roi > 0) {
                recomendacion = 'Inversi√≥n con retorno positivo pero bajo';
                colorROI = 'warning';
            } else {
                recomendacion = 'CUIDADO: Inversi√≥n con p√©rdidas';
                colorROI = 'negative';
            }
            
            container.innerHTML = `
                <div class="results-grid">
                    <div class="result-item">
                        <div class="result-value ${colorROI}">${inversion.roi.toFixed(1)}%</div>
                        <div class="result-label">ROI Total</div>
                    </div>
                    <div class="result-item">
                        <div class="result-value ${inversion.roiAnual > 15 ? 'positive' : 'warning'}">${inversion.roiAnual.toFixed(1)}%</div>
                        <div class="result-label">ROI Anual</div>
                    </div>
                    <div class="result-item">
                        <div class="result-value ${inversion.tiempoRetorno <= 12 ? 'positive' : 'warning'}">${inversion.tiempoRetorno.toFixed(1)}</div>
                        <div class="result-label">Meses Retorno</div>
                    </div>
                    <div class="result-item">
                        <div class="result-value positive">‚Ç°${inversion.beneficioTotal.toLocaleString()}</div>
                        <div class="result-label">Beneficio Total</div>
                    </div>
                </div>
                
                <div class="recommendation">
                    <h4>üí° Recomendaci√≥n</h4>
                    <p>${recomendacion}</p>
                    <p><strong>Flujo mensual neto:</strong> ‚Ç°${inversion.beneficioMensual.toLocaleString()}</p>
                    <p><strong>Tiempo para recuperar inversi√≥n:</strong> ${inversion.tiempoRetorno.toFixed(1)} meses</p>
                </div>
            `;
        }
        
        function actualizarDashboard() {
            if (inversiones.length === 0) {
                document.getElementById('roiPromedio').textContent = '0%';
                document.getElementById('mejorInversion').textContent = '0%';
                document.getElementById('tiempoRetorno').textContent = '0 meses';
                document.getElementById('totalInvertido').textContent = '‚Ç°0';
                document.getElementById('gananciaNeta').textContent = '‚Ç°0';
                document.getElementById('scoreInversion').textContent = '0/10';
                return;
            }
            
            const roiPromedio = inversiones.reduce((sum, inv) => sum + inv.roi, 0) / inversiones.length;
            const mejorROI = Math.max(...inversiones.map(inv => inv.roi));
            const tiempoPromedioRetorno = inversiones.reduce((sum, inv) => sum + inv.tiempoRetorno, 0) / inversiones.length;
            const totalInvertido = inversiones.reduce((sum, inv) => sum + inv.monto, 0);
            const gananciaNeta = inversiones.reduce((sum, inv) => sum + (inv.beneficioTotal - inv.monto), 0);
            
            // Calcular score de calidad de inversiones
            let score = 0;
            if (roiPromedio > 30) score += 3;
            else if (roiPromedio > 15) score += 2;
            else if (roiPromedio > 0) score += 1;
            
            if (tiempoPromedioRetorno <= 6) score += 2;
            else if (tiempoPromedioRetorno <= 12) score += 1;
            
            if (gananciaNeta > totalInvertido * 0.2) score += 2;
            else if (gananciaNeta > 0) score += 1;
            
            const inversionesPositivas = inversiones.filter(inv => inv.roi > 0).length;
            if (inversionesPositivas === inversiones.length) score += 2;
            else if (inversionesPositivas > inversiones.length * 0.7) score += 1;
            
            // Actualizar interfaz
            document.getElementById('roiPromedio').textContent = `${roiPromedio.toFixed(1)}%`;
            document.getElementById('roiPromedio').className = `metric-value ${roiPromedio > 15 ? 'positive' : roiPromedio > 0 ? 'warning' : 'negative'}`;
            
            document.getElementById('mejorInversion').textContent = `${mejorROI.toFixed(1)}%`;
            document.getElementById('tiempoRetorno').textContent = `${tiempoPromedioRetorno.toFixed(1)} meses`;
            document.getElementById('totalInvertido').textContent = `‚Ç°${totalInvertido.toLocaleString()}`;
            document.getElementById('gananciaNeta').textContent = `‚Ç°${gananciaNeta.toLocaleString()}`;
            document.getElementById('gananciaNeta').className = `metric-value ${gananciaNeta > 0 ? 'positive' : 'negative'}`;
            document.getElementById('scoreInversion').textContent = `${score}/10`;
            document.getElementById('scoreInversion').className = `metric-value ${score >= 7 ? 'positive' : score >= 4 ? 'warning' : 'negative'}`;
        }
        
        function actualizarListaInversiones() {
            const lista = document.getElementById('investmentList');
            
            if (inversiones.length === 0) {
                lista.innerHTML = '<p style="text-align: center; color: #666; padding: 40px;">No hay inversiones registradas</p>';
                return;
            }
            
            const inversionesOrdenadas = [...inversiones].sort((a, b) => b.roi - a.roi);
            
            lista.innerHTML = inversionesOrdenadas.map(inv => {
                let roiClass = 'roi-low';
                if (inv.roi > 30) roiClass = 'roi-high';
                else if (inv.roi > 10) roiClass = 'roi-medium';
                
                return `
                    <div class="investment-item">
                        <div class="investment-header">
                            <div class="investment-title">
                                <span class="roi-indicator ${roiClass}"></span>
                                ${inv.nombre}
                            </div>
                            <div class="investment-roi ${inv.roi > 0 ? 'positive' : 'negative'}">
                                ${inv.roi.toFixed(1)}% ROI
                            </div>
                        </div>
                        <div class="investment-details">
                            <div><strong>Inversi√≥n:</strong> ‚Ç°${inv.monto.toLocaleString()}</div>
                            <div><strong>Retorno:</strong> ${inv.tiempoRetorno.toFixed(1)} meses</div>
                            <div><strong>Beneficio:</strong> ‚Ç°${(inv.beneficioTotal - inv.monto).toLocaleString()}</div>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function actualizarSelectoresComparacion() {
            const select1 = document.getElementById('inversion1');
            const select2 = document.getElementById('inversion2');
            
            const options = inversiones.map(inv => 
                `<option value="${inv.id}">${inv.nombre} (${inv.roi.toFixed(1)}% ROI)</option>`
            ).join('');
            
            select1.innerHTML = '<option value="">Seleccionar inversi√≥n</option>' + options;
            select2.innerHTML = '<option value="">Seleccionar inversi√≥n</option>' + options;
        }
        
        function compararInversiones() {
            const id1 = document.getElementById('inversion1').value;
            const id2 = document.getElementById('inversion2').value;
            
            if (!id1 || !id2) {
                alert('Por favor selecciona dos inversiones para comparar');
                return;
            }
            
            if (id1 === id2) {
                alert('Por favor selecciona dos inversiones diferentes');
                return;
            }
            
            const inv1 = inversiones.find(inv => inv.id == id1);
            const inv2 = inversiones.find(inv => inv.id == id2);
            
            const container = document.getElementById('comparacionResultados');
            
            container.innerHTML = `
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>M√©trica</th>
                            <th>${inv1.nombre}</th>
                            <th>${inv2.nombre}</th>
                            <th>Mejor</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>ROI Total</strong></td>
                            <td>${inv1.roi.toFixed(1)}%</td>
                            <td>${inv2.roi.toFixed(1)}%</td>
                            <td>${inv1.roi > inv2.roi ? inv1.nombre : inv2.nombre}</td>
                        </tr>
                        <tr>
                            <td><strong>Inversi√≥n Inicial</strong></td>
                            <td>‚Ç°${inv1.monto.toLocaleString()}</td>
                            <td>‚Ç°${inv2.monto.toLocaleString()}</td>
                            <td>${inv1.monto < inv2.monto ? inv1.nombre + ' (menor)' : inv2.nombre + ' (menor)'}</td>
                        </tr>
                        <tr>
                            <td><strong>Tiempo Retorno</strong></td>
                            <td>${inv1.tiempoRetorno.toFixed(1)} meses</td>
                            <td>${inv2.tiempoRetorno.toFixed(1)} meses</td>
                            <td>${inv1.tiempoRetorno < inv2.tiempoRetorno ? inv1.nombre : inv2.nombre}</td>
                        </tr>
                        <tr>
                            <td><strong>Beneficio Total</strong></td>
                            <td>‚Ç°${(inv1.beneficioTotal - inv1.monto).toLocaleString()}</td>
                            <td>‚Ç°${(inv2.beneficioTotal - inv2.monto).toLocaleString()}</td>
                            <td>${(inv1.beneficioTotal - inv1.monto) > (inv2.beneficioTotal - inv2.monto) ? inv1.nombre : inv2.nombre}</td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="recommendation">
                    <h4>üéØ Recomendaci√≥n Comparativa</h4>
                    <p><strong>Mejor opci√≥n general:</strong> ${
                        inv1.roi > inv2.roi && inv1.tiempoRetorno <= inv2.tiempoRetorno ? inv1.nombre : 
                        inv2.roi > inv1.roi && inv2.tiempoRetorno <= inv1.tiempoRetorno ? inv2.nombre :
                        'Analizar seg√∫n prioridades espec√≠ficas'
                    }</p>
                </div>
            `;
        }
        
        // Inicializar
        actualizarDashboard();
        actualizarListaInversiones();
    </script>
</body>
</html>
                